<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

	<title>DHBW WebServices Marc Ströbel (m.stroebel@gmx.de)</title>

	<link rel="stylesheet" href="dist/reset.css" />
	<link rel="stylesheet" href="dist/reveal.css" />
	<link rel="stylesheet" href="dist/theme/simple.css" id="theme" />

	<!-- Theme used for syntax highlighted code -->
	<link rel="stylesheet" href="plugin/highlight/monokai.css" id="highlight-theme" />
</head>

<body>
	<div class="reveal">
		<div class="slides">
			<section data-markdown>
				<textarea data-template>
					## Vorlesung Webservices
				</textarea>
			</section>
			<section data-markdown>
				<textarea data-template>
					### Themen
					- Historie
					- Architektur
					- Cloud-Technologien ({s|i|p}aas)
					- Cloud-native
					- VM vs. Container
					- Entwicklung - Best practice
					- Vorbereitung Projektarbeit
				</textarea>
			</section>
			<section data-markdown>
				<textarea data-template>
					### Historie
					- Mainframe
					- Desktop-Anwendungen (FatClient)
					- Client/Server-Anwendungen (z.B. Java EE)
					- verteilte Architekturen (Browser-UI, GL, DB)
					- Apps
					- Cloud-Anwendungen
					- ...
				</textarea>
			</section>
			<section data-markdown>
				<textarea data-template>
					### Mainframe
					- serverzentriert, Logik + UI am Server
					- "dumme" Terminals
					- proprietär
					- teuer
					- "Ich denke, dass es weltweit einen Markt für vielleicht fünf Computer gibt" - Thomas Watson (IBM)
 				</textarea>
			</section>
			<section data-markdown>
				<textarea data-template>
					### Desktop-Anwendungen
					- Preisverfall, IBM-PC
					- Logik + UI am Client
					- relativ freie Technologiewahl
					- "Inseln", wenig Schnittstellen
					- "Es gibt keinen Grund, warum jeder einen Computer zu Hause haben sollte." - Ken Olsen (DEC)
					- VisualBasic, Delphi, C/C++ WinApi/MFC
				</textarea>
			</section>
			<section data-markdown>
				<textarea data-template>
					### Client/Server-Anwendungen
					- Logik am Server
					- UI am Client
					- meist 1:1 Beziehung, 1 Client, 1 Backend
					- CORBA, SOAP, RMI
				</textarea>
			</section>
			<section data-markdown>
				<textarea data-template>
					### verteilte Architekturen
					- s. Client/Server
					- SOA-Hype
					- 1:n , 1 Client, mehrere Backends
				</textarea>
			</section>
			<section data-markdown>
				<textarea data-template>
					### Apps
					- s. verteilte Architekturen
					- n:m 
				</textarea>
			</section>
			<section data-markdown>
				<textarea data-template>
					### Cloud-Anwendungen
					- s. verteilte Architekturen
					- There's no cloud, it's just someone else's computer.
				</textarea>
			</section>
			<section data-markdown>
				<textarea data-template>
					### Herausforderungen...
				</textarea>
			</section>
			<section data-markdown>
				<textarea data-template>
					### Klassisches IT-Umfeld
					- eigenes RZ
					- knappe Resourcen
					- gewachsene Prozesse (Dauer HW-Bestellung)
					- Kostendruck
					- trifft auf ...
				</textarea>
			</section>
			<section data-markdown>
				<textarea data-template>
					### neue Geschäftsanforderungen
					- Agilität
					- Globalisierung
					- neue Marktbedingungen: Winner takes all
				</textarea>
			</section>
			<section data-markdown>
				<textarea data-template>
					### Probleme
					- Wartung (Arbeitszeit 07-18 Uhr vs. globale Verfügbarkeit)
					- Lastspitzen (Black Friday...)
					- Big Data
					- IT-Skills
				</textarea>
			</section>
			<section data-markdown>
				<textarea data-template>
					### Cloud-Technologien
					- Saas (Software as a service)
					- Iaas (Infrastructure as a service)
					- Paas (Platform as a service)
					- Cloud-native
				</textarea>
			</section>
			<section id="pizza-as-a-service">
				<h2>Pizza as a Service</h2>
				<p><img data-src="assets/pizzaaas.jpg" /></p>
				<p><span class="mini">Quelle: Albert Barron, IBM</span></p>
			</section>
			<section id="as-a-service">
				<h2>? as a Service</h2>
				<p><img data-src="assets/xaas.svg" /></p>
			</section>
			<section id="typen-von-clouds" data-markdown>
				### Typen von Clouds
				- Traditional IT
				- Public Cloud
				- Private Cloud
				- Hybrid Cloud
			</section>
			<section id="traditionelle-it" data-markdown>
				### Traditionelle IT- Alles In-House
				- Anforderungen erfassen
				- Beschaffung
				- Integration in existierende Systeme
				- Strom, Netzwerk, Kühlung
			</section>
			<section id="public-cloud" data-markdown>
				### Public Cloud
				- betrieben von einem Dienstleister **für die Öffentlichkeit**
				- Massengeschäft
				- **keine** Anpassungen für einzelne Kunden
			</section>
			<section id="private-cloud" data-markdown>
				### Private Cloud
				- betrieben von einem Dienstleister für **einen** Kunden, oder
				- vom Kunden selbst für die eigene Organisation
				- auf kundeneigener oder Dienstleister-Hardware
			</section>
			<section id="hybrid-cloud" data-markdown>
				### Hybrid Cloud
				- Verbindung von public und private Cloud
				- Workload kann frei verschoben werden, je nach Anforderung
			</section>
			<section id="potentiale-1" data-markdown>
				### Potentiale (1)
				- Einsparung von Personalkosten durch Standardisierung und Automatisierung von
				- Konfiguration
				- Betrieb
				- Verwaltung
				- Überwachung
			</section>
			<section id="potentiale-2" data-markdown>
				### Potentiale (2)
				- Verbesserte Kapitalnutzung durch erhöhte Auslastung der Hardware
				- Verringerte Lizenzkosten durch gemeinsamen Betrieb
				- Beschleunigte Bereitstellung von Resourcen (Minuten statt Tagen)
			</section>
			<section id="risikofaktoren-1" data-markdown>
				### Risikofaktoren (1)
				- Vendor Lock-in
				- Gewährleistung und Haftung
				- Cloud-Anbieter haben ggf. Geschäftsbeziehung mit Endanwender (Fernabsatzgesetz, AGB, MWSt.)
				- Urheberrecht (an Software und den mit ihr erstellten Werken)
				- Datenschutz (“EU-Cloud”)
			</section>
			<section id="risikofaktoren-2" data-markdown>
				### Cloud-native
				- pets vs. cattle
				- 12 factor apps
			</section>
			<section id="pets-vs-cattle-1" data-markdown>
				### pets vs. cattle
				- Jemand installiert Standard-Software auf einem Server
				- Eine andere Person kopiert selbstentwickelte Software dorthin und startet sie manuell
				- Ein Dritter konfiguriert System- und Anwendungssoftware
				- Was passiert, wenn der Server kaputt geht?
			</section>
			<section id="pets-vs-cattle-2" data-markdown>
				### pets vs. cattle
				- Automatisierung
				- Infrastructure as code
				- Tools Chef, Ansible ...
			</section>
			<section id="die-12-faktoren-1" data-markdown>
				### Die 12 Faktoren (1)
				- Eine im Versionsmanagementsystem verwaltete Codebase, viele Deployments
				- Abhängigkeiten explizit deklarieren und isolieren
				- die Konfiguration in Umgebungsvariablen ablegen
			</section>
			<section id="die-12-faktoren-2" data-markdown>
				### Die 12 Faktoren (2)
				- Unterstützende Dienste als angehängte Ressourcen behandeln
				- Build- und Run-Phase strikt trennen
				- Die App als einen oder mehrere Prozesse ausführen
			</section>
			<section id="die-12-faktoren-3" data-markdown>
				### Die 12 Faktoren (3)
				- Dienste durch das Binden von Ports exportieren
				- Nebenläufigkeit wird durch das Skalieren individueller Prozesse ermöglicht
				- Schneller Start/Stopp ermöglicht robuste Anwendungen
			</section>
			<section id="die-12-faktoren-4" data-markdown>
				### Die 12 Faktoren (4)
				- Entwicklung, Staging und Produktion so ähnlich wie möglich halten
				- Logs als Strom von Ereignissen behandeln
				- Admin/Management-Aufgaben als einmalige Vorgänge behandeln
			</section>
			<section id="containers" data-markdown>
				### VM
			</section>
			<section id="containers" data-markdown>
				### ganz kurz
				- HW wird in SW abgebildet
				- Vollvirtualisierung: ARM auf Amd/Intel (z.B. Qemu, Android-Emulator)
				- Paravirtualisierung: Identische Architektur, Beschleunigung durch CPU-Features
				- emuliertes Netzwerk, Storage usw.
			</section>
			<section id="containers" data-markdown>
				### Vorteile
				- einfach wiederherstellbar (Snapshot)
				- kopierbar (Works on my machine ...)
				- HW-unabhängig (emulierte HW bleibt gleich)
			</section>
			<section id="containers" data-markdown>
				### Container
			</section>
			<section id="was-sind-container" data-markdown>
				#### Was sind Container?
			</section>
			<section id="gütertransport-vor-ca.-1960">
				<h2>Gütertransport vor ca. 1960</h2>
				<p><img data-src="assets/cargo-transport-pre-1960.png" /></p>
			</section>
			<section id="matrix-from-hell">
				<h2>Matrix from Hell</h2>
				<p><img data-src="assets/also-a-matrix-from-hell.png" /></p>
			</section>
			<section id="lösung-container-für-alles">
				<h2>Lösung: Container für alles</h2>
				<p><img data-src="assets/intermodal-shipping-container.png" /></p>
			</section>
			<section id="staging-vor-2013¹">
				<h2>Staging vor 2013¹</h2>
				<p><img data-src="assets/the-challenge.png" /></p>
				<p>[1] vor Docker</p>
			</section>
			<section id="auch-hier-matrix-from-hell">
				<h2>Auch hier: Matrix from Hell</h2>
				<p><img data-src="assets/the-matrix-from-hell.png" /></p>
			</section>
			<section id="container-vereinheitlichen-die-matrix">
				<h2>Container vereinheitlichen die Matrix</h2>
				<p><img data-src="assets/eliminates-matrix-from-hell.png" /></p>
			</section>
			<section id="wie" data-markdown>
				<h2>Wie?</h2>
				<p><img data-src="assets/shipping-container-for-code.png" /></p>
			</section>
			<section id="warum-ist-das-für-die-entwicklung-interessant" data-markdown>
				#### Warum ist das für die Entwicklung interessant?
				- Läuft "überall"
				- Einheitliche Umgebung in dev, staging &amp; prod
				- Alle Abhängigkeiten enthalten
				- Apps teilen sich keine Abhängigkeiten
			</section>
			<section id="warum-ist-das-für-die-entwicklung-interessant-2" data-markdown>
				### Warum ist das für die Entwicklung interessant? (2)
				- Einheitlicher Lebenszyklus ermöglicht Standardisierung von
				- Deployment
				- Start
				- Stop
				- Scaling
				- Löschen

				Keine Kompatibilitätsprobleme mehr (?)
			</section>
			<section id="warum-ist-das-für-den-betrieb-interessant" data-markdown>
				### Warum ist das für **den Betrieb** interessant?
				siehe oben plus:
				- Kaum teurer als Prozesse (vgl. VM)
				- Weit weniger Hardware benötigt
				- Einheitlicher Lebenszyklus **aller** Services
				- Effizienzgewinn durch Standardisierung
				- Continuous Deployment wird stark vereinfacht
				- Trennung der Verantwortlichkeiten
			</section>
			<section id="trennung-der-verantwortlichkeiten">
				<h2>Trennung der Verantwortlichkeiten</h2>
				<p><img data-src="assets/separation-of-concerns.png" /></p>
			</section>
			<section id="idee-1">
				<h2>Idee</h2>
				<p>
					<?xml version='1.0' encoding='UTF-8' standalone='no'?>
					<svg xmlns='http://www.w3.org/2000/svg' width='640' height='210'
						shape-rendering='geometricPrecision' version='1.0'>
						<defs>
							<filter id='f2' x='0' y='0' width='200%' height='200%'>
								<feOffset result='offOut' in='SourceGraphic' dx='5' dy='5' />
								<feGaussianBlur result='blurOut' in='offOut' stdDeviation='3' />
								<feBlend in='SourceGraphic' in2='blurOut' mode='normal' />
							</filter>
						</defs>
						<g stroke-width='1' stroke-linecap='square' stroke-linejoin='round'>
							<rect x='0' y='0' width='640' height='210' style='fill: #ffffff' />
							<path stroke='gray' fill='gray' filter='url(#f2)'
								d='M213.0 91.0 L213.0 173.0 L37.0 173.0 L37.0 91.0 z' />
							<path stroke='gray' fill='gray' filter='url(#f2)'
								d='M305.0 175.0 L615.0 175.0 L615.0 147.0 L305.0 147.0 z' />
							<path stroke='gray' fill='gray' filter='url(#f2)'
								d='M213.0 119.0 L213.0 145.0 L37.0 145.0 L37.0 119.0 z' />
							<path stroke='gray' fill='gray' filter='url(#f2)'
								d='M213.0 149.0 L213.0 173.0 L37.0 173.0 L37.0 149.0 z' />
							<path stroke='#000000' stroke-width='1.000000' stroke-linecap='round'
								stroke-linejoin='round' fill='white'
								d='M213.0 91.0 L213.0 173.0 L37.0 173.0 L37.0 91.0 z' />
							<path stroke='#000000' stroke-width='1.000000' stroke-linecap='round'
								stroke-linejoin='round' fill='white'
								d='M305.0 175.0 L615.0 175.0 L615.0 147.0 L305.0 147.0 z' />
							<path stroke='#000000' stroke-width='1.000000' stroke-linecap='round'
								stroke-linejoin='round' fill='white'
								d='M213.0 119.0 L213.0 145.0 L37.0 145.0 L37.0 119.0 z' />
							<path stroke='#000000' stroke-width='1.000000' stroke-linecap='round'
								stroke-linejoin='round' fill='none' d='M485.0 35.0 L575.0 35.0 L575.0 133.0 ' />
							<path stroke='#000000' stroke-width='1.000000' stroke-linecap='round'
								stroke-linejoin='round' fill='white'
								d='M213.0 149.0 L213.0 173.0 L37.0 173.0 L37.0 149.0 z' />
							<path stroke='#000000' stroke-width='1.000000' stroke-linecap='round'
								stroke-linejoin='round' fill='none' d='M305.0 91.0 L305.0 35.0 L395.0 35.0 ' />
							<path stroke='#000000' stroke-width='1.000000' stroke-linecap='round'
								stroke-linejoin='round' fill='none' d='M615.0 147.0 L615.0 49.0 L585.0 49.0 ' />
							<path stroke='none' stroke-width='1.000000' stroke-linecap='round' stroke-linejoin='round'
								fill='#000000' d='M260.0 98.0 L270.0 105.0 L260.0 112.0 z' />
							<path stroke='#000000' stroke-width='1.000000' stroke-linecap='round'
								stroke-linejoin='round' fill='none' d='M155.0 91.0 L155.0 111.0 ' />
							<path stroke='#000000' stroke-width='1.000000' stroke-linecap='round'
								stroke-linejoin='round' fill='none' d='M95.0 91.0 L95.0 111.0 ' />
							<path stroke='#000000' stroke-width='1.000000' stroke-linecap='round'
								stroke-linejoin='round' fill='none' d='M385.0 63.0 L315.0 63.0 ' />
							<path stroke='#000000' stroke-width='1.000000' stroke-dasharray='5.000000,5.000000'
								stroke-miterlimit='0' stroke-linecap='butt' stroke-linejoin='round' fill='white'
								d='M325.0 119.0 L555.0 119.0 ' />
							<path stroke='#000000' stroke-width='1.000000' stroke-linecap='round'
								stroke-linejoin='round' fill='none' d='M475.0 63.0 L405.0 63.0 ' />
							<path stroke='#000000' stroke-width='1.000000' stroke-linecap='round'
								stroke-linejoin='round' fill='none' d='M495.0 63.0 L565.0 63.0 ' />
							<path stroke='#000000' stroke-width='1.000000' stroke-linecap='round'
								stroke-linejoin='round' fill='none' d='M305.0 91.0 L565.0 91.0 ' />
							<path stroke='#000000' stroke-width='1.000000' stroke-linecap='round'
								stroke-linejoin='round' fill='none' d='M395.0 35.0 L395.0 77.0 ' />
							<path stroke='#000000' stroke-width='1.000000' stroke-linecap='round'
								stroke-linejoin='round' fill='none' d='M485.0 35.0 L485.0 77.0 ' />
							<path stroke='#000000' stroke-width='1.000000' stroke-linecap='round'
								stroke-linejoin='round' fill='none' d='M395.0 35.0 L485.0 35.0 ' />
							<path stroke='#000000' stroke-width='1.000000' stroke-linecap='round'
								stroke-linejoin='round' fill='none' d='M305.0 147.0 L305.0 91.0 ' />
							<text x='50' y='110' font-family='Courier' font-size='13' stroke='none' fill='#000000'>
								<![CDATA[App]]>
							</text>
							<text x='56' y='138' font-family='Courier' font-size='15' stroke='none' fill='#000000'>
								<![CDATA[Betriebssystem]]>
							</text>
							<text x='80' y='166' font-family='Courier' font-size='15' stroke='none' fill='#000000'>
								<![CDATA[Hardware]]>
							</text>
							<text x='110' y='110' font-family='Courier' font-size='13' stroke='none' fill='#000000'>
								<![CDATA[App]]>
							</text>
							<text x='170' y='110' font-family='Courier' font-size='13' stroke='none' fill='#000000'>
								<![CDATA[App]]>
							</text>
							<text x='340' y='54' font-family='Courier' font-size='13' stroke='none' fill='#000000'>
								<![CDATA[App]]>
							</text>
							<text x='325' y='82' font-family='Courier' font-size='15' stroke='none' fill='#000000'>
								<![CDATA[rootfs]]>
							</text>
							<text x='376' y='138' font-family='Courier' font-size='15' stroke='none' fill='#000000'>
								<![CDATA[Betriebssystem]]>
							</text>
							<text x='400' y='166' font-family='Courier' font-size='15' stroke='none' fill='#000000'>
								<![CDATA[Hardware]]>
							</text>
							<text x='430' y='54' font-family='Courier' font-size='13' stroke='none' fill='#000000'>
								<![CDATA[App]]>
							</text>
							<text x='415' y='82' font-family='Courier' font-size='15' stroke='none' fill='#000000'>
								<![CDATA[rootfs]]>
							</text>
							<text x='414' y='110' font-family='Courier' font-size='15' stroke='none' fill='#000000'>
								<![CDATA[Kernel]]>
							</text>
							<text x='505' y='82' font-family='Courier' font-size='15' stroke='none' fill='#000000'>
								<![CDATA[rootfs]]>
							</text>
							<text x='590' y='68' font-family='Courier' font-size='15' stroke='none' fill='#000000'>
								<![CDATA[D ]]>
							</text>
							<text x='590' y='82' font-family='Courier' font-size='15' stroke='none' fill='#000000'>
								<![CDATA[o ]]>
							</text>
							<text x='590' y='96' font-family='Courier' font-size='15' stroke='none' fill='#000000'>
								<![CDATA[c ]]>
							</text>
							<text x='590' y='110' font-family='Courier' font-size='15' stroke='none' fill='#000000'>
								<![CDATA[k ]]>
							</text>
							<text x='590' y='124' font-family='Courier' font-size='15' stroke='none' fill='#000000'>
								<![CDATA[e ]]>
							</text>
							<text x='590' y='138' font-family='Courier' font-size='15' stroke='none' fill='#000000'>
								<![CDATA[r ]]>
							</text>
							<text x='520' y='54' font-family='Courier' font-size='13' stroke='none' fill='#000000'>
								<![CDATA[App]]>
							</text>
						</g>
					</svg>
				</p>
			</section>
			<section id="achtung" data-markdown>
				### Achtung:
				#### Containers == Docker?
				Falsch!
			</section>
			<section id="geschichte" data-markdown>
				### Geschichte
				- Linux Kernel: process isolation
				- Namespaces (2006)
				- cgroups (2007)
				- LXC (2008)
				- CF Warden (2011)
				- Docker (2013)
			</section>
			<section id="docker" data-markdown>
				#### Docker
				- dotCloud (..2013)
				- Marketing
				- Tooling
				- Mindshare (!)
			</section>
			<section id="ab-hier" data-markdown>
				### Ab hier
				#### Containers =~ Docker
			</section>
			<section id="docker-bestandteile" data-markdown>
				### Docker: Bestandteile
				- Image: Vorlage oder Bauplan für Container
				- Container: eine Instanz eines Images, die ausgeführt wird
				- Registry: verwaltet Images
				- Engine: Laufzeit-Plattform
			</section>
			<section id="docker-engine">
				<h2>Docker Engine</h2>
				<p><img data-src="assets/engine-components-flow.png" /></p>
				<aside class="notes">
					<ul>
						<li>Server: langlaufender Prozess (daemon)</li>
						<li>Client: CLI tool zur Kommunikation mit dem Server</li>
						<li>REST API: Standard-Schnittstelle</li>
					</ul>
				</aside>
			</section>
			<section id="architektur-2">
				<h2>Architektur</h2>
				<p><img data-src="assets/docker-architecture.svg" /></p>
			</section>
			<section id="hands-on" data-markdown>
				### Hands-on
			</section>
			<section id="container-starten" data-markdown>
				<h2>Container starten</h2>
				``` shell
				docker run -it --rm alpine sh
				Unable to find image alpine:latest locally
				Pulling from library/alpine
				Digest: sha256:f006ecbb824d87947d0b51ab8488634bf69fe4094959d935c0c103f4820a417d
				Status: Downloaded newer image for alpine:latest
				```
			</section>
			<section id="was-ist-passiert" data-markdown>
				### Was ist passiert?
				- Image heruntergeladen
				- Container gestarted
				- mit interaktivem Terminal
				- Shell gestartet
				- Shell interaktiv beendet
				</ul>
			</section>
			<section id="containers-vs.-vms">
				<h2>Containers vs. VMs</h2>
				<table style="width:94%;">
					<colgroup>
						<col style="width: 27%" />
						<col style="width: 33%" />
						<col style="width: 33%" />
					</colgroup>
					<thead>
						<tr class="header">
							<th></th>
							<th>VMs</th>
							<th>Container</th>
						</tr>
					</thead>
					<tbody>
						<tr class="odd">
							<td>emuliert wird</td>
							<td>(physische) Hardware</td>
							<td>OS (Kernel)</td>
						</tr>
						<tr class="even">
							<td>Resourcen-Zugriff</td>
							<td>Hypervisor</td>
							<td>Kernel-Features</td>
						</tr>
						<tr class="odd">
							<td>beschränkt auf</td>
							<td>–</td>
							<td>Linux, Windows</td>
						</tr>
						<tr class="even">
							<td>Overhead</td>
							<td>relativ hoch</td>
							<td>relativ gering</td>
						</tr>
					</tbody>
				</table>
			</section>
			<section id="container-image" data-markdown>
				### Container-Image
				- beschrieben durch Dockerfile
				- Text-Datei mit Schritten zum Bau des Images
				- gebaut mit
				``` shell
				docker build .
				```
			</section>
			<section id="dockerfile" data-markdown>
				### Dockerfile
				- FROM: Basis-Image (‘abgeleitet von’ oder ‘basiert auf’)
				- RUN: Kommando ausführen und Ergebnis als Layer committen
				- ADD: Lokale Dateien und Verzeichnisse hinzufügen
				- CMD: Was bei "docker run" passiert
				- EXPOSE: Deklaration von Ports (vgl. --publish)
				- ENV : Umgebungsvariablen setzen
			</section>
			<section id="multi-container-orchestration" data-markdown>
				### Multi-Container Orchestration
				Ein Container kommt selten allein:
				- Three-tier web app
				- Wordpress (PHP-files + MySQL)
			</section>
			<section id="prinzip" data-markdown>
				### Prinzip
				- YAML-Datei beschreibt eine “Komposition” aus mehreren Containern (‘Services’)
				- Image (z.B. postgres oder php)
				- Volumes
				- Abhängigkeiten
				- Umgebungsvariablen
				- Ports
				- etc.
			</section>
			<section id="docker-basic" data-markdown>
				#### Anwendungen in Container "verpacken" - Allgemein
				- 1 Container = (im Idealfall) 1 Prozess
				- Anwendung als Binary
				- Interpreter + Source (PHP, JavaScript, ...)
				- JAVA : JVM + JAR
			</section>
			<section id="docker-java" data-markdown>
				#### Anwendungen in Container "verpacken" - Java
				- Basis-Container (z.B. openjdk:latest)
				- FAT-JAR erzeugen (IDE, besser per Build-Tool maven, gradle...)
				- alternativ: Classpath mit java cp-Parameter manuell setzen
			</section>
			<section id="container-image" data-markdown>
				#### Anwendungen in Container "verpacken" - Java
				``` shell
				FROM openjdk:11
				ADD target/docker-test-0.0.1-SNAPSHOT.jar /
				RUN cd /
				EXPOSE 8080
				CMD java -jar docker-test-0.0.1-SNAPSHOT.jar
				```
			</section>
			<section id="docker-node" data-markdown>
				#### Anwendungen in Container "verpacken" - JavaScript/TypeScript
				- Abhängigkeiten installieren (npm install)
				- TypeScript build (z.B. npm run build)
				- Basis-Container (z.B. node:15.5.1-alpine3.10)
				- JavaScript src-Order hinzufügen
				- node_modules hinzufügen
			</section>
			<section id="container-image" data-markdown>
				#### Anwendungen in Container "verpacken" - JavaScript/TypeScript
				``` shell
				FROM node:15.5.1-alpine3.10
				RUN mkdir /app
				ADD dist /app/dist
				ADD node_modules /app/node_modules
				EXPOSE 3000
				ENTRYPOINT ["node", "/app/dist/main.js"]
				```
			</section>
			<section id="docker-php" data-markdown>
				#### Anwendungen in Container "verpacken" - PHP
				- Basis-Container (z.B. php:apache)
				- src-Order hinzufügen
			</section>
			<section id="docker-entrypoint-cmd" data-markdown>
				#### ENTRYPOINT vs. CMD
				- Entrypoint ist statisch, kann nicht überschrieben werden
				- CMD kann vom Aufrufer gesetzt / überschrieben werden
			</section>
			<section id="docker-db" data-markdown>
				### DB starten mit Port-Freigabe
				``` shell
				docker run --name some-postgres --rm -e POSTGRES_PASSWORD=test -p 5432:5432 -d postgres
				```
			</section>
			<section id="docker-file-ref" data-markdown>
				### Referenz
				https://docs.docker.com/engine/reference/builder/
			</section>
			<section id="docker-build-container1">
				<h4>Exkurs: CI/CD</h4>
				<p><img data-src="assets/ci-cd-flow-mobile_0.png" /></p>
				<p>CI/CD sorgt nicht nur für eine höhere Geschwindigkeit, sondern auch für eine bessere
					Softwarequalität. Bildquelle: Red Hat</p>
			</section>
			<section id="docker-build-container2" data-markdown>
				### Build-Container - Vorteile
				- zustandslos, ermöglicht reproduzierbare Builds
				- isoliert, z.B. parallel mehrere Versionen einer Runtime möglich
				- Java 8 / Java 11, PHP 7.x / PHP 8
				- vgl. klassische Installation auf Server :-(
			</section>
			<section id="docker-build-container3" data-markdown>
				### Build-Container 2
				- Bind-Mounts für Einbindung Host-Dateisystem

				```shell
				docker run -it --rm --name my-maven-project \\
				-v "$(pwd)":/usr/src/mymaven \\
				-w /usr/src/mymaven maven mvn clean package
				```
			</section>
			<section id="docker-init-container" data-markdown>
				### Init-Container
				- werden als Teil das Deployments gestartet (div. Stages möglich, je nach Umgebung...)
				- Backups, DB-Migration, ...
			</section>
			<section id="docker-flyway" data-markdown>
				### Beispiel Flyway
				- DB-Migration
				- Infrastructure as code
				- undo möglich
				```shell
				V1__initial.sql
				V2__add_chats_table.sql
				```
			</section>
			<section id="docker-flyway1" data-markdown>
				### Beispiel Flyway
				- SQL-Dialekt

				V1__initial.sql
				```sql
				CREATE TABLE MyTable (
				MyColumn VARCHAR(100) NOT NULL
				);
				```
			</section>
			<section id="docker-flyway1" data-markdown>
				### Beispiel Flyway
				V2__add.sql
				```sql
				ALTER TABLE MyTable ADD MyColumn2 VARCHAR(100) NOT NULL;
				```
			</section>
			<section id="docker-flyway2" data-markdown>
				### Verwendung
				```shell
				docker run --rm -v /absolute/path/to/my/sqldir:/flyway/sql \\
				flyway/flyway -url=jdbc:h2:mem:test -user=sa migrate
				```
			</section>
			<section id="docker-flyway" data-markdown>
				### Verwendung
				- ... undo - letzte Migration zurücknehmen
				- ... clean - Db loeschen
			</section>
			<section id="docker-compose" data-markdown>
				### einfache Container-Orchestrierung
				```yaml
				services:
				db:
				image: postgres:latest
				environment:
				POSTGRES_USER: pspdfkit
				POSTGRES_PASSWORD: password
				...
				```
			</section>
			<section id="docker-compose1" data-markdown>
				### Reihenfolge
				```yaml
				services:
				web:
				build: .
				depends_on:
				- db
				...
				```
				Container db wird bei "up" vor web gestartet
			</section>
			<section id="docker-compose2" data-markdown>
				### Referenz
				https://docs.docker.com/compose/compose-file/compose-file-v3/
			</section>
			<section id="spring-db" data-markdown>
				## WebServices mit Java/Spring
				- Datenbankanbindung
				- ORM: JPA (Java Persistence Architecture)
				- Plain: JDBC
				- R2DC: Reactive Relational Database Connectivity
			</section>
			<section id="jpa-entity" data-markdown>
				### JPA-Basics
				- Entity-Klasse anlegen

				```java
				@Entity
				public class OrderEntity {}
				```
			</section>
			<section id="jpa-entity-table" data-markdown>
				### JPA-Basics
				- optional: Tabelle vorgeben

				```java
				@Entity
				@Table(name = "orders")
				public class OrderEntity {}
				```
			</section>
			<section id="jpa-entity-pk" data-markdown>
				### JPA-Basics
				- Primary key festlegen

				```java
				@Entity
				@Table(name = "orders")
				public class OrderEntity {
				@Id // Primary key
				@GeneratedValue // Auto increment
				public Integer id;
				}
				```
			</section>
			<section id="jpa-entity-column" data-markdown>
				### JPA-Basics
				- optional: Spalten vorgeben

				```java
				@Entity
				@Table(name = "orders")
				public class OrderEntity {
				@Id // Primary key
				@GeneratedValue // Auto increment
				public Integer id;
				}

				@Column(name="desc")
				public String description;
				```
			</section>
			<section id="jpa-repo" data-markdown>
				### JPA-Basics
				- Repository-Interface anlegen

				``` java
				interface OrderRepo extends JpaRepository&lt;OrderEntity, Integer&gt;

				```
			</section>
			<section id="jpa-queries" data-markdown>
				### JPA-Basics
				- Queries definieren
				- Convention over Configuration
				- Impl wird automatisch generiert!

				``` java
				// exact match
				List&lt;OrderEntity&gt; findByDescription(String description);
				List&lt;OrderEntity&gt; findByDescriptionIgnoreCase(String description);
				// like
				List&lt;OrderEntity&gt; findByDescriptionContaining(String description);
				// like
				List&lt;OrderEntity&gt; findByDescriptionEndingWith(String description);
				// mehrere Spalten
				List&lt;OrderEntity&gt; findByDescriptionContainingAndTitle(String description, String title);

				```
			</section>
			<section id="jpa-ref" data-markdown>
				### Spring queries reference
				-
				https://docs.spring.io/spring-data/data-jpa/docs/current/reference/html/#jpa.query-methods.query-creation
			</section>
			<section id="jpa-onetomany" data-markdown>
				### JPA-Basics
				- Relationen

				``` java
				@Entity
				class Cart {
				@Id
				@GeneratedValue
				@Column(name="cart_id")
				public Integer id;
				@OneToMany(mappedBy="cart")
				private Set&lt;Item&gt; items;
				}

				@Entity
				class Item {
				@ManyToOne
				@JoinColumn(name="cart_id", nullable=false)
				private Cart cart;
				}

				```
			</section>
			<section id="jpa-db-setup-rel" data-markdown>
				### JPA-Basics
				- Relationen

				``` sql
				CREATE TABLE `Cart` (
				`cart_id` int(11) unsigned NOT NULL AUTO_INCREMENT,
				PRIMARY KEY (`cart_id`)
				);

				CREATE TABLE `Items` (
				`id` int(11) unsigned NOT NULL AUTO_INCREMENT,
				`cart_id` int(11) unsigned NOT NULL,
				PRIMARY KEY (`id`),
				KEY `cart_id` (`cart_id`),
				CONSTRAINT `items_ibfk_1` FOREIGN KEY (`cart_id`)
				REFERENCES `Cart` (`cart_id`)
				); ```
			</section>
			<section id="jpa-manytomany1" data-markdown>
				### JPA-Basics
				- ManyToMany

				``` java
				@Entity
				class Staff {
				@Id
				@GeneratedValue
				@Column(name="staff_id")
				public Integer id;
				@ManyToMany(cascade = { CascadeType.ALL })
				@JoinTable(
				name = "Staff_Project",
				joinColumns = { @JoinColumn(name = "staff_id") },
				inverseJoinColumns = { @JoinColumn(name = "project_id") }
				)
				private Set&lt;Project&gt; projects = new HashSet&lt;&gt;();
				// standard constructors/getters/setters
				}
				```
			</section>
			<section id="jpa-manytomany2" data-markdown>
				### JPA-Basics
				- ManyToMany

				``` java
				@Entity
				@Table(name = "Project")
				public class Project {
				// ...

				@ManyToMany(mappedBy = "projects")
				private Set&lt;Staff&gt; staff = new HashSet&lt;&gt;();

				// standard constructors/getters/setters
				}
				```
			</section>
			<section id="jpa-custom-queries" data-markdown>
				### JPA-Basics
				- Custom queries

				``` java
				@Query("SELECT f FROM OrderEntity f WHERE LOWER(f.description) = LOWER(:description)")
				OrderEntity retrieveByDescription(@Param("description") String description);

				```
			</section>
			<section id="jpa-transactions-method" data-markdown>
				### JPA-Basics
				- Transaktionen
				
				``` java
				//method level
				@Transactional
				public void method() {}
				
				```
			</section>
			<section id="jpa-transactions-class" data-markdown>
				### JPA-Basics
				- Transaktionen
				
				``` java
				//class level
				@Transactional
				public class MyService {}
				
				
				```
			</section>
			<section id="jpa-links" data-markdown>
				### Links zu Spring + DB
				- https://www.baeldung.com/the-persistence-layer-with-spring-data-jpa
				- https://www.baeldung.com/hibernate-one-to-many
				- https://www.baeldung.com/hibernate-many-to-many
			</section>
			<section id="jdbc-setup1" data-markdown>
				### JDBC-Basics
				- Setup

				``` java
				@Service
				class Repo {
				private JdbcTemplate jdbcTemplate;
				public Repo(JdbcTemplate jdbcTemplate) {
				this.jdbcTemplate = jdbcTemplate;
				}
				}

				```
			</section>
			<section id="jdbc-setup2" data-markdown>
				### JDBC-Basics
				- Setup

				``` java
				public int addEmplyee(int id) {
				return jdbcTemplate.update(
				"INSERT INTO EMPLOYEE VALUES (?, ?, ?, ?)", id, "Bill", "Gates", "USA");
				}
				```
			</section>
			<section id="jdbc-setup-named-params1" data-markdown>
				### JDBC-Basics
				- Setup NamedParameterJdbcTemplate

				``` java
				@Service
				class Repo {
				private NamedParameterJdbcTemplate jdbcTemplate;
				public Repo(NamedParameterJdbcTemplate jdbcTemplate) {
				this.jdbcTemplate = jdbcTemplate;
				}
				}

				```
			</section>
			<section id="jdbc-setup-named-params2" data-markdown>
				### JDBC-Basics
				- Named parameters

				``` java
				SqlParameterSource namedParameters = new MapSqlParameterSource().addValue("id", 1);
				return namedParameterJdbcTemplate.queryForObject(
				"SELECT FIRST_NAME FROM EMPLOYEE WHERE ID = :id", namedParameters, String.class);
				```
			</section>
			<section id="jdbc-java-mapping1" data-markdown>
				### JDBC-Basics
				- Setup Java-Mapping

				``` java
				public class EmployeeRowMapper implements RowMapper&lt;Employee&gt; {
				@Override
				public Employee mapRow(ResultSet rs, int rowNum) throws SQLException {
				Employee employee = new Employee();

				employee.setId(rs.getInt("ID"));
				employee.setFirstName(rs.getString("FIRST_NAME"));
				employee.setLastName(rs.getString("LAST_NAME"));
				employee.setAddress(rs.getString("ADDRESS"));

				return employee;
				}
				}
				```
			</section>
			<section id="jdbc-java-mapping2" data-markdown>
				### JDBC-Basics

				``` java
				String query = "SELECT * FROM EMPLOYEE WHERE ID = ?";
				Employee employee = jdbcTemplate.queryForObject(
				query, new Object[] { id }, new EmployeeRowMapper());
				```
			</section>
			<section id="jdbc-links" data-markdown>
				### Links zu Spring + JDBC
				- https://www.baeldung.com/spring-jdbc-jdbctemplate
			</section>
			<section id="r2dc" data-markdown>
				### R2DC-Basics
				- non-blocking (vs. JDBC)
				- benötigt Reactive Spring aka WebFlux
			</section>
		        <section id="r2dc-entity" data-markdown>
				### Entities
				- siehe JPA
				- aber: (noch) keine Relationen
			</section>
			<section id="r2dc-repo" data-markdown>
				### Repository
				- Repository-Interface anlegen

				``` java
				interface OrderRepo extends ReactiveCrudRepository&lt;OrderEntity, Integer&gt;

				```
			</section>
			<section id="r2dc-queries" data-markdown>
				### R2DC-Queries
				``` java
				Mono&lt;OrderEntity&gt; findById(Integer id);
				Flux&lt;OrderEntity&gt; findByDescription(String description);

				```
			</section>
			<section id="jpa-jdbc-r2dc" data-markdown>
				### JPA vs. JDBC vs. R2DC
				- Was wann verwenden?
			</section>
			<section id="jpa-usage" data-markdown>
				### JPA
				- hohe Abstraktion
				- Schutz vor SQL-Injection ootb
				- erw. Features: SQL-Reorder, Caching, Prefetch, ...
			</section>
			<section id="jdbc-usage" data-markdown>
				### JDBC 
				- Zugriff auf DB-spezifische Features
				- SQL für Geschäftslogik
				- komplexe Queries (bestehende DB)
			</section>
			<section id="r2dc-usage" data-markdown>
				### R2DC
				- Reactive Spring
				- Skalierung (keine Threadpools usw.)
				- einfaches Datenmodell (wg. Relationen)
			</section>
		        <section id="db-arch" data-markdown>
				## Ausflug SW-Architektur
				- ActiveRecord vs. DataMapper
			</section>
			<section id="db-arch-data-mapper" data-markdown>
				### DataMapper
				- Entity: entspricht einer Tabelle
				- Repository: LowLevel-Zugriffe
			</section>
			<section id="db-arch-data-mapper-model" data-markdown>
				### DataMapper
				- aus OO-Sicht Antipattern
				- (Domänen-)Klassen ohne Logik
				- Logik meist in Service-Klassen verstreut
			</section>
		        <section id="db-arch-active-record" data-markdown>
				### ActiveRecord
				- (Domänen-)Klassen enthalten Logik und DB-Zugriffe
				- eher OO-Style
			</section>
			<section id="db-arch-active-record-impl" data-markdown>
				### Implementierung (Spring)
				``` java
				// Pojo
				public class Order {
				  private final OrderRepository orderRepository;
				  private OrderEntity orderEntity;
				
				  public Order(OrderRepository orderRepository) {
				    this.orderRepository = orderRepository;
				  }
				}
				```
			</section>
			<section id="db-arch-active-record-impl2" data-markdown>
				``` java
				public class Order {
				  //...		
				  public void load(Integer id) {
				    this.orderEntity = this.orderRepository.findById(id);
				  }
				
				  public void save() {//...}
				
				  public BigDecimal calculateShippingCost() {//...}
				}
				```
			</section>
			<section id="projektarbeit" data-markdown>
				## Vorbereitung Projektarbeit
				- Übungsprojekt
			</section>
			<section id="webshop">
				<h2>Webshop</h2>
				<p><img data-src="assets/webshop.svg" /></p>
			</section>
			<section id="webshop-sequenzdiagramm">
				<p><img data-src="assets/webshop-sequenzdiagramm.png" /></p>
			</section>
			<section id="webshop-architektur">
				<p><img data-src="assets/webshop-architektur.png" /></p>
			</section>
			<section id="webshop-architektur-ssr" data-markdown>
				### klassische Webanwendung
				- SSR (Server side rendering)
				- ASP.NET, PHP, Spring Thymeleaf, ...
				- nur Webshop-Container von extern erreichbar
				- serverseitiger Zugriff auf Backends problemlos möglich
			</section>
			<section id="webshop-architektur-ssr-bild">
				<p><img data-src="assets/webshop-architektur-ssr.png" /></p>
			</section>
			<section id="webshop-architektur-spa" data-markdown>
				### Webanwendung als SPA
				- Angular, React, Webcomponents, ...
				- Backend-Zugriffe erfolgen jetzt vom Client aus (Browser)
			</section>
			<section id="webshop-architektur-spa-bild">
				<p><img data-src="assets/webshop-architektur-spa.png" /></p>
			</section>
			<section id="webshop-architektur-spa2" data-markdown>
				### Webanwendung als SPA
				- komplexes Routing
				- alles von extern erreichbar
				- eher nicht ...
			</section>
			<section id="webshop-architektur-spa2" data-markdown>
				### Backend for Frontend (BFF)
				#### (aka API-Gateway)
				- zusätzliche Komponente übernimmt Routing als externes Gateway
				- nur dieses Gateway muss erreichbar sein
				- optional zentraler Punkt für Security, Monitoring, ...
			</section>
			<section id="webshop-architektur-bff">
				<p><img data-src="assets/webshop-architektur-bff.png" /></p>
			</section>
			<section id="spring-boot-rest1" data-markdown>
				### REST-APIs mit Spring - Hands on
			</section>
			<section id="spring-boot-rest2" data-markdown>
				### Produktsuche - Warenkorb
				- eindeutige ID für Warenkorb erforderlich
				- Ansatz 1: Cookie setzen bein ersten Zugriff, Wert = Warenkorb-ID
				- Ansatz 2: Warenkorb-ID in Session speichern
				- Ansatz 3: Warenkorb-ID als Hidden Field im HTML-Formular speichern
				- Ansatz 4: Warenkorb-ID als Teil der URL im Hinzuf&uuml;gen-Buttons hinterlegen
			</section>
			<section id="spring-boot-rest3" data-markdown>
				### Cookie auslesen
				``` java
				@PostMapping("/api/cart")
				public ResponseEntity&lt;Cart&gt; createCartFromCookie(@CookieValue(value = "cartId", required = false)
				String cartId) {
				//Cookie erzeugen, falls nicht vorhanden
				HttpCookie cookie = ResponseCookie.from("cartId", cartId == null || cartId.isEmpty() ?
				UUID.randomUUID().toString() : cartId)
				.path("/")
				.httpOnly(true)
				.secure(true)
				.build();
				//...
				return ResponseEntity.ok().header(HttpHeaders.SET_COOKIE, cookie.toString()).body(cart);
				}
				```
			</section>
			<section id="spring-boot-rest-session" data-markdown>
				### Session auslesen
				``` java
				@PostMapping("/api/cart")
				public ResponseEntity&lt;Cart&gt; createCartFromSession(HttpSession httpSession) {
				String cartId = httpSession.getAttribute("cartId");
				// Id generieren, wenn nicht vorhanden...
				// ...
				}
				```
			</section>
			<section id="spring-boot-rest4" data-markdown>
				### Zugriff auf Query-Parameter
				``` java
				@GetMapping("/api/products")
				public List&lt;Item&gt; findProducts(@RequestParam("query", required = false) String query) {
				}
				```
				https://www.baeldung.com/spring-request-param
			</section>
			<section id="spring-boot-rest5" data-markdown>
				### Zugriff auf Pfad-Parameter
				``` java
				@GetMapping("/api/cart/{cartId}")
				public List&lt;Item&gt; findProducts(@PathVariable("cartId", required = true) String cartId) {
				}
				```
				https://www.baeldung.com/spring-requestparam-vs-pathvariable
			</section>
			<section id="spring-boot-rest6" data-markdown>
				### Zugriff auf Request-Body
				- Standard: JSON-Mapping (kann konfiguriert werden)

				``` java
				@PutMapping("/api/item/{cartId}")
				public CartItem modifyItem(@PathVariable("cartId", required = true) String cartId,
				@RequestBody CartItem item) {
				}
				```

				https://www.baeldung.com/spring-request-response-body
			</section>
			<section id="rest-url-mapping" data-markdown>
				### Mapping API-ID DB-ID
				- keine sequenziellen IDs in der API benutzen
				- Anzeige von nicht erlaubten Daten durch Manipulation der ID möglich
				- meist Programmierfehler als Ursache -&gt; defensiver Ansatz
			</section>
			<section id="rest-url-mapping2" data-markdown>
				### Mapping API-ID DB-ID
				- besser: eigene IDs für API generieren und in der DB speichern
				- z.B. UUID, breite Unterstützung in Libs
				- Query erfolgen dann mit dieser ID
				- evtl. Optimierung mit Indizes auf ID-Spalte
			</section>
			<section id="rest-url-mapping3" data-markdown>
				### Mapping API-ID DB-ID
				``` java
				@Entity
				@Table(indexes = @Index(columnList = "apiId"))
				public class CartItem {

				@Id
				@GeneratedValue
				public Integer id;

				@Column(name="api-id")
				public String apiId;

				//...
				}
				```
				https://www.baeldung.com/jpa-indexes
			</section>

			<section id="rest-url-mapping4" data-markdown>
				### Mapping API-ID DB-ID
				``` java

				public interface CartItemRepo extends JpaRepo... {


				List&lt;CartItem&gt; findByApiId(String id);
				}
				```
			</section>
			<section id="rest-url-mapping5" data-markdown>
				### Mapping API-ID DB-ID
				- Kompromiss für einfache Fälle: UUID als Primary Key verwenden
			</section>
			<section id="uebung1" data-markdown>
				### Besprechung Übungsaufgabe
			</section>
			<section id="uebung2" data-markdown>
				### Artikel in Warenkorb legen
				- Als Link (href)
				- Problem: Seitenwechsel (Page reload)
				- letzte Suche serverseitig cachen (Session, Db, ...) und neu generieren
				- oder: letzte Suche in Cookie/LocalStorage ablegen
				- Hinweis anzeigen problemlos per Template ("Artikel wurde in den Warenkorb gelegt, x Artikel im
				Warenkorb")
			</section>
			<section id="uebung3" data-markdown>
				### Artikel in Warenkorb legen
				- asynchron per JavaScript
				- kein Seitenwechsel
			</section>
			<section id="uebung4" data-markdown>
				### Button mit Id oder data-Attribut

				``` html
				&lt;button id="uuid" data-uuid="uuid" onClick="addToCart(this.id)"&gt;Add to cart&lt;/button&gt;
				```
			</section>
			<section id="uebung4_1" data-markdown>
				### OnClick-Handler im Script Tag
				``` html
				&lt;script&gt;
				function addToCart(clicked_id) {
				const Http = new XMLHttpRequest();
				const url = '/api/....';
				Http.open("PUT", url);
				Http.send({
				id: clicked_id
				});

				Http.onreadystatechange = (e) => {
				console.log(Http.responseText)
				}
				}
				&lt;/script&gt;
				```

			</section>
			<section id="uebung5" data-markdown>
				### Plain-Javascript
				- mittlerweile gut standardisiert (neuere Browser)
				- alternativ JavaScript-Libs verwenden
				- Vue.js
				- Angular/React -&gt; Single Page App
			</section>
			<section id="uebung6" data-markdown>
				### Anwort/Hinweis anzeigen
				- Anzeige per HTML-DOM

				```
				&lt;script&gt;
				function addToCart(clicked_id) {
				// ...
				Document.getElementById("Id_des_Hinweis-Divs").innerText = "...";
				}
				&lt;/script&gt;
				```

			</section>
			<section id="rest-api1" data-markdown>
				### REST-Apis - Best practice
				- Dokumentation
				- Stabilität (Resilience)
				- Versionierung
				- Fehlerbehandlung
			</section>
			<section id="rest-api2" data-markdown>
				### Dokumentation
				- leider kein einheitlicher Ansatz
				- [OpenApi (aka Swagger)](https://swagger.io/specification/)
				- speziell: [Spring Rest Docs](https://docs.spring.io/spring-restdocs/docs/current/reference/html5/)
			</section>
			<section id="rest-api3" data-markdown>
				### Stabilität
				- Eingabedaten validieren
				- JSON-Schema, XML-Schema, Validierungsregeln als Code...

				[Fail fast](https://de.wikipedia.org/wiki/Fail-Fast)
			</section>
			<section id="rest-api4" data-markdown>
				### Stabilität
				- Tolerant-Reader-Pattern für Clients und Server einsetzen
				- Mapping auf definierte Ein/Ausgabestrukturen, alles was nicht passt wird ignoriert
				- eigenes Datenmodell für API-Layer
				- alternativ: Tool-Unterstützung konsequent nutzen (z.B. JsonIgnore...)

				[TolerantReader](https://martinfowler.com/bliki/TolerantReader.html)
			</section>
			<section id="rest-api5" data-markdown>
				### Stabilität
				- ermöglicht kompatible Weiterentwicklung
				- hinzufügen neuer Felder problemlos möglich
				- (alte) Clients funktionieren weiterhin
			</section>
			<section id="rest-api6" data-markdown>
				### Stabilität
				- Http-Timeouts setzen (warten auf Hintergrund-Dienste blockt Worker-Threads)

				[Spring-Timeouts setzen](https://www.baeldung.com/spring-rest-timeout)
			</section>
			<section id="rest-api7" data-markdown>
				### Stabilität
				- eigene Thread-Pools für Http-Requests und Hintergrund-Jobs

				[Thread-Pools](https://www.baeldung.com/thread-pool-java-and-guava)

				[Pool-Config](https://www.baeldung.com/java-web-thread-pool-config)
			</section>
			<section id="rest-api8" data-markdown>
				### Stabilität
				- Services sind zustandslos
				- d.h. keine Request-spezifischen Daten in Klassenvariablen ablegen
				- Persistenz nur über die Datenbank
			</section>
			<section id="rest-api9" data-markdown>
				### Stabilität
				- in Prod-Setup meist mehrere Instanzen eines Service aktiv (Load-Balancer)
				- nicht sicher ob der nächste Request wieder von derselben Instanz verarbeitet wird
			</section>
			<section id="rest-api10" data-markdown>
				### Versionierung
				- Regel 1: nicht versionieren
			</section>
			<section id="rest-api11" data-markdown>
				### Versionierung
				- Problem: mit dem Release der (Public-)API hat man keine Kontrolle mehr...
				- keine Breaking-Changes mehr möglich
				- Nutzer sind nicht sehr erfreut, wenn sie alle 4 Wochen Anwendungen ohne erkennbaren Mehrwert ändern
				müssen
			</section>
			<section id="rest-api12" data-markdown>
				### Versionierung - Bad practice
				- per Url /api/v1/...
				- in den Nutzdaten
			</section>
			<section id="rest-api13" data-markdown>
				### technisch möglich, aber eigentlich kein REST
				- ...v1 ist keine Resource
				- Nutzdaten nicht für "Technik" (SOAP)
			</section>
			<section id="rest-api14" data-markdown>
				### Versionierung - Besser
				- per Http-Header Accept / Content-Type
				```
				Content-Type: application/json;api=v1
				```
			</section>
			<section id="rest-api15" data-markdown>
				### Versionierung - Vermeidung
				- s. TolerantReader
				- Objekte / Arrays nutzen
			</section>
			<section id="rest-api16" data-markdown>
				```json
				{
				"addresses": [
				{
				"city": "..."
				},
				{
				"key": "shipping",
				"city": "..."
				}
				]
				}
				```
			</section>
			<section id="rest-api17" data-markdown>
				### Versionierung - Vermeidung
				- alte Clients verwenden erste Adresse aus der Liste
				- ursprünglich 1 Eintrag enthalten, Anforderung Lieferadresse kam später
				- entsprechend aufbereiten
			</section>
			<section id="rest-api18" data-markdown>
				### Versionierung - Vermeidung
				- Daten duplizieren
			</section>
			<section id="rest-api19" data-markdown>
				```json
				{
				"firstName": "",
				"lastName": ""
				}
				```
			</section>
			<section id="rest-api20" data-markdown>
				```json
				{
				"firstName": "",
				"lastName": "",
				name: {
				"firstName": {
				"primaryName": "",
				"additionalNames": [],
				},
				"lastName": "".
				}
				}
				```
			</section>
			<section id="rest-api21" data-markdown>
				### Duplizieren
				- Mapping-Code erforderlich: Elemente zu Name-Objekt
				- "neue" Felder bleiben leer
				- Fachlichkeit arbeitet intern mit den neuen Strukturen
				- "Altlasten" nur in API-Schicht
			</section>
			<section id="rest-api22" data-markdown>
				### Duplizieren
				- neue Felder müssen vorbelegbar oder optional sein
			</section>
			<section id="rest-api23" data-markdown>
				### Fehlerbehandlung
				#### Problem: verteilte Prozesslogik
			</section>
			<section id="rest-api24" data-markdown>
				### Fehlerbehandlung
				- klassischer Ansatz Transactions -> Rollback -> atomar
				- bei Microservices nicht möglich
				- lose Kopplung per Http
				- mehrere DBs
			</section>
			<section id="rest-api25">
				<p><img data-src="assets/error-handling.png" /></p>
			</section>
			<section id="rest-api26" data-markdown>
				### Fehlerzustand
				- Order wurde angelegt
				- Stock wurde aktualisiert
				- Payment wurde angelegt? Oder auch nicht?
				- Rollback?
				- und wenn beim Rollback ein Fehler auftritt?
			</section>
			<section id="rest-api27" data-markdown>
				### Fehlerbehandlung
				- Retry
				- Rollback
				- ...
			</section>
			<section id="rest-api28" data-markdown>
				### Unterscheidung Art des Fehlers (REST)
				- 4xx Client Fehler
				- 5xx Server Fehler
			</section>
			<section id="rest-api29" data-markdown>
				### 401/403 Auth Problem
				- Retry nutzlos
				- Account gesperrt
			</section>
			<section id="rest-api29" data-markdown>
				### 404 not found
				- Retry nutzlos
			</section>
			<section id="rest-api30" data-markdown>
				### 400 bad request / 422 unprocessable entity
				- Validierungsfehler
			</section>
			<section id="rest-api31" data-markdown>
				### 500 internal error
				- Retry denkbar
			</section>
			<section id="saga-pattern1" data-markdown>
				### Saga-Pattern für verteilte Transaktionen
				- jede Operation bekommt eine eindeutige Id in der Db
				- Operationen mit Zustand (pending, done, error, ...) abspeichern (Historie)
				- für jeden Schreibzugriff existiert ein Rollback (zu programmieren)
				- Retry bei Fehlern vorsehen (mehrfache Aufrufe mit identischer ID haben keine Auswirkungen)
			</section>
			<section id="saga-pattern2">
				<p><img data-src="assets/error-handling-saga.png" /></p>
			</section>
			<section id="saga-pattern3" data-markdown>
				### Rollback
				- Ver&auml;nderungen statt (End-)Zust&auml;nden speichern
				- Bankkonto: Startwert + Liste aller Ums&auml;tze statt Kontostand speichern
			</section>
			<section id="saga-pattern4" data-markdown>
				### Stock service
				| op-id | product-id | count | timestamp |
				|-------------:| -----:| ---:|-----:|
				| abc | 123 | 5 |
				| def | 456 | 1 |
				| def | 789 | 1 |
			</section>
			<section id="saga-pattern5" data-markdown>
				### Rollback
				- Zustand zu jedem Zeitpunkt wiederherstellbar
			</section>
			<section id="saga-pattern6" data-markdown>
				### Zusammenfassung
				- fachliche Fehler können zuverl&auml;ssig behandelt werden (Artikel nicht ausreichend auf Lager)
				- Daten nicht immer konsistent (Latenz, während Rollback)
				- fachliche Anforderungen pr&uuml;fen (siehe Onlinebanking...)
				- Fehler beim Rollback nicht immer zu beheben (einzige M&ouml;glichkeit: x Retry)
				- Logging, eigene Tabelle für Kl&auml;rf&auml;lle (Sachbearbeiter)
			</section>
			<section id="saga-pattern7" data-markdown>
				### Zusammenfassung
				- Architektur &uuml;berdenken....
			</section>
			<section id="architektur1" data-markdown>
				### Architekturen für komplexe Anwendungen
				- Monolith
				- Microservices
				- Microlyths/Moduliths (verteilte Monolithen)

				[Monolith vs.
				Microservice](https://www.n-ix.com/microservices-vs-monolith-which-architecture-best-choice-your-business/)
			</section>
			<section id="architektur2" data-markdown>
				### Monolith
				- klassische Webanwendung
				- kann nur als Ganzes ausgerollt/skaliert werden
				- relativ enge Kopplung
				- UI - Backend - DB

				[Schaubild](https://d2m6ke2px6quvq.cloudfront.net/uploads/2020/09/11/3f3de3fc-f3a8-4cd1-81cd-518496f59141.jpg)
			</section>
			<section id="architektur3" data-markdown>
				### Vorteile
				- einfaches Deployment
				- wenig Abstraktion
				- einheitliche Technologie
				- Transaktionen nutzbar
			</section>
			<section id="architektur4" data-markdown>
				### Nachteile
				- Parallelisierung (mehrere Teams) schwierig
				- Verantwortlichkeiten unklar
				- Updates: alles oder nichts
			</section>
			<section id="architektur5" data-markdown>
				### Microservices
				- Fachlichkeit in einzelne Services auslagern
				- eigene DB pro Service
				- optional: UI pro Service (Microfrontends)

				[Schaubild](https://d2m6ke2px6quvq.cloudfront.net/uploads/2020/09/11/2381c271-4fde-4cc1-94d9-a2e2d72a81c0.jpg)
			</section>
			<section id="architektur6" data-markdown>
				### Microservices - Vorteile
				- für jeden Service die passende Technologie nutzbar
				- loose Kopplung
				- Parallelentwicklung einfach (1-x Microservices/Team)
				- einfach zu testen
				- einfache Updates
				- schnell mal "was ausprobieren"
			</section>
			<section id="architektur7" data-markdown>
				### Microservices - Nachteile
				- komplexes Deployment
				- komplexe Fehlerbehandlung
				- komplexes Monitoring
				- Overhead durch Service-Calls
				- keine Transaktionen über mehrere Services
			</section>
			<section id="architektur8" data-markdown>
				### Microlyths/Moduliths
				- Schnitt nach komplexen Use-Cases
				- gemeinsame DB
				- einheitliche Technik
				- asynchrone Kommunikation zwischen Systemen
			</section>
			<section id="architektur8" data-markdown>
				### Microlyths/Moduliths - Vorteile
				- klare Verantwortlichkeiten
				- überschaubarere Umfang
				- einfache Deployment/Monitoring
			</section>
			<section id="architektur8" data-markdown>
				### Microlyths/Moduliths - Nachteile
				- Updates: alles oder nichts
			</section>
			<section id="architektur9" data-markdown>
				### Auswahlkriterien
				| | Monolith | Microservice | Modulith |
				| ------------- |:-------------:| -----:| ---:|
				| viele Teams | - | + | + |
				| schnelle Entwicklung | - | + | -/+ |
				| strikte (Technik-)Vorgaben | +| - | - |
				| Skalierung/Last/... nicht einheitlich | - | + | -/+ |
			</section>
			<section id="architektur10">
				<p><img data-src="assets/matrix.jpg" /></p>
				<a
					href="https://www.ufried.com/blog/microservices_fallacy_10_microliths/">https://www.ufried.com/blog/microservices_fallacy_10_microliths/</a>
			</section>
			<section id="architektur11" data-markdown>
				### Microfrontends

				[Microfrontends](https://martinfowler.com/articles/micro-frontends.html)
			</section>
			<section id="architektur12" data-markdown>
				### Microfrontends
				- Links
				- SSI (Server Side Includes)
				- Templates
				- Komponenten (Build-Time)
				- Web-Components
			</section>
			<section id="architektur13" data-markdown>
				### Links
				- jeder Microservice bringt seine eigene UI mit
				- Abstimmung CSS, Styling (Navbar...)
				- freie Wahl der Technik (klassisches serverseitiges Rendering, SPA)
				- Übergabe Callack-Url Zur&uuml;ck-Funktion
			</section>
			<section id="architektur14" data-markdown>
				### Links - Wann?
				- Wizard-Layout
				- abgeschlossene Prozessschritte
			</section>
			<section id="architektur15" data-markdown>
				### Links - Nachteile
				- Ladezeiten
				- Layout nicht 100% einheitlich bei unterschiedlichen Technologien
			</section>
			<section id="architektur16" data-markdown>
				### SSI
				- Aufruf von serverseitigen Skripten (z.B. Shell, PHP) anhand von Tags im HTML
				- klassische Webserver-Funktionalit&auml;t (mod_ssi)

				[SSI](https://martinfowler.com/articles/micro-frontends.html#Server-sideTemplateComposition)
			</section>
			<section id="architektur17" data-markdown>
				### Templates (serverseitig)
				- Anwendungsrahmen (Web-Shell)
				- Microservices liefern Seiten-Fragmente (HTML-String)
				- HTML wird in die Bereiche (Header,Footer, ...) eingef&uuml;gt (Template-Engine)
			</section>
			<section id="architektur18" data-markdown>
				### Anwendungsrahmen
				- Grundlayout
				- ext. Abh&auml;ngigkeiten (JavaScript, CSS)
				- Shell / Microservices können relativ unabhängig ausgeliefert werden
			</section>
			<section id="architektur19" data-markdown>
				### Templates (clientseitig)
				- Anwendungsrahmen (Web-Shell)
				- Microservices liefern Seiten-Fragmente
				- HTML wird per JavaScript wird in die Bereiche eingef&uuml;gt (innerHtml)

				[IntegrationViaJavascript](https://martinfowler.com/articles/micro-frontends.html#Run-timeIntegrationViaJavascript)
			</section>
			<section id="architektur20" data-markdown>
				### Templates - Wann?
				- klar getrennte unabh&auml;ngige Bereiche
			</section>
			<section id="architektur21" data-markdown>
				### Templates - Nachteile
				- Layout nicht 100% einheitlich bei unterschiedlichen Technologien
			</section>
			<section id="architektur22" data-markdown>
				### Komponenten
				- SPA
				- abh&auml;ngig vom eingesetzten Framework (Angular, React,...)
				- Anwendungsrahmen (Web-Shell)
				- Frontend-Build f&uuml;hrt Webshell und Komponenten zusammen
				- muss zusammen deployed werden
				- -&gt;Frontend-Monolith
			</section>
			<section id="architektur23" data-markdown>
				### Komponenten
				- automatische Tests essentiell
				- Framework vorgegeben
			</section>
			<section id="architektur24" data-markdown>
				### Web-Components

				[Web-Components](https://martinfowler.com/articles/micro-frontends.html#Run-timeIntegrationViaWebComponents)
			</section>
		</div>
	</div>
	[]
	<script src="dist/reveal.js"></script>
	<script src="plugin/notes/notes.js"></script>
	<script src="plugin/markdown/markdown.js"></script>
	<script src="plugin/highlight/highlight.js"></script>
	<script>
		// More info about initialization & config:
		// - https://revealjs.com/initialization/
		// - https://revealjs.com/config/
		Reveal.initialize({
			hash: true,
			slideNumber: true,
			// Learn about plugins: https://revealjs.com/plugins/
			plugins: [RevealMarkdown, RevealHighlight, RevealNotes],
		});
	</script>
</body>
</html>
